{% extends 'accounts/staff_dashboard.html' %}
{% load static %}

{% block title %}Staff Appointments{% endblock %}

{% block content %}

<div class="appointments_center" style="display: flex; justify-content: center;">
{% if messages %}
    <div class="staff-alerts">
        {% for message in messages %}
            <div class="staff-alert staff-alert--{{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
    </div>
{% endif %}
{% if appointments %}
    <div class="user_appointments">
        <div class="appointment_title">
            <div>Resident Name</div>
            <div>Certificate Type</div>
            <div>Appointment Date</div>
            <div>Appointment Time</div>
            <div>Purpose</div>
            <div>Status</div>
            <div style="text-align: center;">Actions</div>
        </div>
        {% for appointment in appointments %}
            <div class="appointment_content">
                <div>{{ appointment.resident.resident.first_name }} {{ appointment.resident.resident.last_name }}</div>
                <div>{{ appointment.get_certificate_type_display }}</div>
                <div>{{ appointment.preferred_date }}</div>
                <div>{{ appointment.preferred_time }}</div>
                <div>{{ appointment.purpose }}</div>
                <div class="status">
                    <span class="status-badge status-badge--{{ appointment.status }}">{{ appointment.get_status_display }}</span>
                </div>
                <div class="status-actions">
                    <form method="post" class="status-actions__form">
                        {% csrf_token %}
                        <input type="hidden" name="appointment_id" value="{{ appointment.id }}">
                        <button type="submit"
                                name="action"
                                value="approve"
                                class="status-button status-button--approve"
                                aria-label="Approve appointment for {{ appointment.resident.resident.first_name }} {{ appointment.resident.resident.last_name }}"
                                {% if appointment.status == 'approved' or appointment.status == 'completed' or appointment.status == 'cancelled' %}disabled{% endif %}>
                            Approve
                        </button>
                        <button type="submit"
                                name="action"
                                value="decline"
                                class="status-button status-button--decline"
                                aria-label="Decline appointment for {{ appointment.resident.resident.first_name }} {{ appointment.resident.resident.last_name }}"
                                {% if appointment.status == 'cancelled' %}disabled{% endif %}>
                            Decline
                        </button>
                    </form>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div>You have no upcoming appointments.</div>
{% endif %}
</div>

{% endblock %}

