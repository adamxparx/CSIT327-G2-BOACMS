{% extends 'accounts/dashboard.html' %}
{% load static %}

{% block title %}Documentary Requirements | Barangay OACMS{% endblock %}

{% block content %}
<div class="requirements-wrapper">
  <div class="requirements-card">
    <div class="requirements-header">
      <h2 class="requirements-title">Documentary Requirements</h2>
      <p class="requirements-subtitle">Please prepare the following documents for your appointment</p>
    </div>

    <div class="requirements-tabs">
      <div class="tabs">
        <button class="tab active" data-tab="clearance">Barangay Clearance</button>
        <button class="tab" data-tab="indigency">Certificate of Indigency</button>
        <button class="tab" data-tab="cedula">Community Tax Certificate</button>
        <button class="tab" data-tab="soloparent">Solo Parent Certificate</button>
      </div>

      <div class="tab-content active" id="clearance-content">
        <div class="requirement-details">
          <h3>Barangay Clearance Requirements</h3>
          <ul class="requirement-list">
            <li><i class="fas fa-check"></i> Valid Government-Issued ID (Passport, Driver's License, UMID, Voter's ID)</li>
            <li><i class="fas fa-check"></i> Proof of Residency (Utility bill, rental contract, or ID with your address)</li>
            <li><i class="fas fa-check"></i> Community Tax Certificate (Cedula)</li>
          </ul>
        </div>
      </div>

      <div class="tab-content" id="indigency-content">
        <div class="requirement-details">
          <h3>Certificate of Indigency Requirements</h3>
          <ul class="requirement-list">
            <li><i class="fas fa-check"></i> Valid Government-Issued ID</li>
            <li><i class="fas fa-check"></i> Proof of Residency</li>
            <li><i class="fas fa-check"></i> Proof of Income (or Affidavit of No Income)</li>
          </ul>
        </div>
      </div>

      <div class="tab-content" id="cedula-content">
        <div class="requirement-details">
          <h3>Community Tax Certificate (Cedula) Requirements</h3>
          <ul class="requirement-list">
            <li><i class="fas fa-check"></i> Valid Government-Issued ID</li>
            <li><i class="fas fa-check"></i> Proof of Income (latest payslip, ITR, or certification of salary)</li>
          </ul>
        </div>
      </div>

      <div class="tab-content" id="soloparent-content">
        <div class="requirement-details">
          <h3>Solo Parent Certificate Requirements</h3>
          <ul class="requirement-list">
            <li><i class="fas fa-check"></i> Valid Government-Issued ID</li>
            <li><i class="fas fa-check"></i> Birth Certificate/s of your child/children</li>
            <li><i class="fas fa-check"></i> Proof of Solo Parent Status:
              <ul class="nested-list">
                <li><strong>For Widows/Widowers:</strong> Death Certificate of the spouse</li>
                <li><strong>For Unmarried Parents:</strong> CENOMAR and Affidavit of Solo Parent</li>
                <li><strong>For Separated/Annulled:</strong> Judicial decree of separation/annulment</li>
                <li><strong>For Abandonment:</strong> Police report or Affidavit of Abandonment</li>
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <div class="note">
        <i class="fas fa-info-circle"></i>
        <p>Please prepare the original and one (1) photocopy of the required documents to bring on your appointment day.</p>
      </div>

      <form method="get" action="{% url 'certification' %}" id="proceed-form">
        {% for key, value in request.GET.items %}
          {% if key != 'csrfmiddlewaretoken' %}
            <input type="hidden" name="{{ key }}" value="{{ value }}">
          {% endif %}
        {% endfor %}
        <input type="hidden" id="certificate-type-input" name="certificate_type" value="">
        <div class="form-submit">
          <button type="submit" class="proceed-button">
            <i class="fas fa-arrow-right"></i> Proceed to Booking
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const tabs = document.querySelectorAll('.tab');
  const tabContents = document.querySelectorAll('.tab-content');
  const proceedForm = document.getElementById('proceed-form');
  const certificateTypeInput = document.getElementById('certificate-type-input');
  
  // Map tab data attributes to certificate type values
  const tabToCertificateType = {
    'clearance': 'barangay_clearance',
    'indigency': 'certificate_of_indigency',
    'cedula': 'community_tax_certificate',
    'soloparent': 'solo_parent_certificate'
  };
  
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      // Remove active class from all tabs and contents
      tabs.forEach(t => t.classList.remove('active'));
      tabContents.forEach(c => c.classList.remove('active'));
      
      // Add active class to clicked tab
      tab.classList.add('active');
      
      // Show corresponding content
      const tabId = tab.getAttribute('data-tab');
      const content = document.getElementById(`${tabId}-content`);
      if (content) {
        content.classList.add('active');
      }
    });
  });
  
  // Set certificate type when form is submitted
  proceedForm.addEventListener('submit', function(e) {
    const activeTab = document.querySelector('.tab.active');
    if (activeTab) {
      const tabId = activeTab.getAttribute('data-tab');
      certificateTypeInput.value = tabToCertificateType[tabId] || '';
    }
  });
});
</script>
{% endblock %}