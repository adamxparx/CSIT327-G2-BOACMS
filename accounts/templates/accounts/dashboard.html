{% extends 'accounts/base_dashboard.html' %}
{% load static %}

{% block title %}{{ user.resident.last_name }} | Dashboard{% endblock %}

{% block resident_css %}
    <link rel="stylesheet" href="{% static 'accounts/css/dropdown.css' %}">
    <style>
        .resident-name-link {
            color: inherit;
            text-decoration: none;
        }
        .resident-name-link:hover {
            text-decoration: none;
        }
    </style>
{% endblock %}

{% block appbar %}
    <ul>
        <li><a href="{% url 'dashboard' %}" {% if request.resolver_match.url_name == 'dashboard' %}aria-current="page"{% endif %}>HOME</a></li>
        <li><a href="{% url 'certification' %}" {% if request.resolver_match.url_name == 'certification' or request.resolver_match.url_name == 'create_appointment' %}aria-current="page"{% endif %}>CERTIFICATIONS</a></li>
        <li><a href="{% url 'appointments' %}" {% if request.resolver_match.url_name == 'appointments' or request.resolver_match.url_name == 'appointment_detail' %}aria-current="page"{% endif %}>APPOINTMENTS {% if claimed_appointments %}<button class="appointment_count approved_count">{{ claimed_appointments }}</button>{% endif %}</a></li>
    </ul>
{% endblock %}

{% block user %}
<div><a href="{% url 'profile' %}" class="resident-name-link">{{ user.resident.first_name }} {{ user.resident.last_name }}</a></div>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="welcome-section">
        <h1>Welcome, <a href="{% url 'profile' %}" class="resident-name-link">{{ user.resident.first_name }}</a>!</h1>
        <p>Manage your appointments and certifications</p>
    </div>

    <!-- Quick Stats Section -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon"></div>
            <div class="stat-info">
                <h3>{{ pending_appointments }}</h3>
                <p>Pending</p>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon"></div>
            <div class="stat-info">
                <h3>{{ approved_appointments }}</h3>
                <p>Approved</p>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon"></div>
            <div class="stat-info">
                <h3>{{ cancelled_appointments }}</h3>
                <p>Cancelled</p>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon"></div>
            <div class="stat-info">
                <h3>{{ completed_appointments }}</h3>
                <p>Completed</p>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <h2>Quick Actions</h2>
        <div class="actions-grid">
            <a href="{% url 'certification' %}" class="action-card">
                <div class="action-icon">+</div>
                <h3>Book Appointment</h3>
                <p>Schedule a new certification</p>
            </a>
            <a href="{% url 'appointments' %}" class="action-card">
                <div class="action-icon">ðŸ“‹</div>
                <h3>View All</h3>
                <p>See all appointments</p>
            </a>
            <a href="{% url 'profile' %}" class="action-card">
                <div class="action-icon">ðŸ‘¤</div>
                <h3>Profile</h3>
                <p>Update information</p>
            </a>
        </div>
    </div>

    <!-- Upcoming Appointments Preview -->
    {% if next_appointment %}
    <div class="upcoming-section">
        <h2>Your Next Appointment</h2>
        <div class="appointment-preview">
            <div class="appointment-details">
                <h3>{{ next_appointment.get_certificate_type_display }}</h3>
                <p><strong>Date:</strong> {{ next_appointment.preferred_date|date:"F d, Y" }}</p>
                <p><strong>Time:</strong> {{ next_appointment.preferred_time|time:"g:i A" }}</p>
                <p><strong>Status:</strong> <span class="status-{{ next_appointment.status }}">{{ next_appointment.get_status_display }}</span></p>
            </div>
            <a href="{% url 'appointment_detail' next_appointment.id %}" class="view-details-btn">View Details</a>
        </div>
    </div>
    {% endif %}

    <!-- Helpful Resources -->
    <div class="resources-section">
        <h2>Helpful Resources</h2>
        <div class="resources-grid">
            <a href="{% url 'requirements' %}" class="resource-card">
                <h3>Certificate Requirements</h3>
                <p>See documents needed for each certification</p>
            </a>
            <div class="resource-card no-highlight">
                <h3>Office Hours</h3>
                <p>Monday - Friday: 9:00 AM - 5:00 PM</p>
                <p>Saturday: Closed</p>
                <p>Sunday: Closed</p>
            </div>
            <div class="resource-card no-highlight">
                <h3>Contact Information</h3>
                <p>Email: barangay.labangon@yahoo.com</p>
                <p>Phone:  260-7194</p>
                <p>Address: Katipunan St., Labangon, Cebu City, Cebu 6000</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}